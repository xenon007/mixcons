# AGENT.md ‚Äì¬†–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è XCC¬†Mixer –≤ –∫–æ–Ω—Å–æ–ª—å–Ω—É—é —É—Ç–∏–ª–∏—Ç—É / DLL

> –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è Codex‚Äë–∞–≥–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.

## 1. –ö–æ–Ω—Ç–µ–∫—Å—Ç

XCC¬†Mixer¬†‚Äî —Å—Ç–∞—Ä—ã–π Win32/MFC‚Äë–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∏–≥—Ä Westwood (MIX, SHP, PAL, AUD‚Ä¶). –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ **Library/**, –∞ GUI‚Äë—à–Ω—ã–π –∫–æ–¥ –∂–∏–≤—ë—Ç –æ—Ç–¥–µ–ª—å–Ω–æ. –ú—ã —Ö–æ—Ç–∏–º –≤—ã–Ω–µ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **mixcons** –∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å C‚Äë–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ –≤–∏–¥–µ **xcc\_mix.dll**.

## 2. –¶–µ–ª–∏

* üì¶ **mixcons.exe**: –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è CLI‚Äë—É—Ç–∏–ª–∏—Ç–∞

  * –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã –∏–∑ MIX‚Äë–∞—Ä—Ö–∏–≤–∞
  * –î–µ–∫–æ–¥–∏—Ä—É–µ—Ç SHP‚Äë–≥—Ä–∞—Ñ–∏–∫—É –≤ PNG —Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø–∞–ª–∏—Ç—Ä–æ–π
  * –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞—Ç—å –≤—ã—Ö–æ–¥–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏ —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º
* üß© **xcc\_mix.dll**: —Ç–æ–Ω–∫–∞—è DLL —Å —Ñ—É–Ω–∫—Ü–∏–µ–π `Mix_Extract` –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (C#/Python)
* üõ† **CMake**‚Äë—Å–±–æ—Ä–∫–∞, CI‚Äëworkflow –Ω–∞ GitHub Actions

## 3. –û–±–ª–∞—Å—Ç—å —Ä–∞–±–æ—Ç (task list)

1. **Bootstrap**

   * [ ] –î–æ–±–∞–≤–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π `CMakeLists.txt` –≤ –∫–æ—Ä–µ–Ω—å
   * [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–ø—Ü–∏—é `BUILD_SHARED_LIBS` (ON¬†‚Äî¬†dll, OFF¬†‚Äî¬†static)
   * [ ] –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å MSVC¬†‚â•¬†v142, GCC¬†11+, Clang¬†13+
2. **CLI¬†—É—Ç–∏–ª–∏—Ç–∞**

   * [ ] –°–æ–∑–¥–∞—Ç—å —Ü–µ–ª—å `mixcons` (type: EXECUTABLE)
   * [ ] –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `Library`, `misc` (zlib, libpng, stb\_image\_write)
   * [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ä—Å–µ—Ä –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –Ω–∞¬†[cxxopts](https://github.com/jarro2783/cxxopts)
   * [ ] –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤ `src/mixcons/main.cpp`

     ```cpp
     mixcons <mix> <pal> [-o <dir>] [--no-shp] [--only-ext="aud,wav"]
     ```
3. **DLL¬†–æ–±—ë—Ä—Ç–∫–∞**

   * [ ] –¶–µ–ª—å `xcc_mix` (type: SHARED)
   * [ ] –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é

     ```cpp
     extern "C" __declspec(dllexport)
     int __stdcall Mix_Extract(const wchar_t* mix,
                               const wchar_t* pal,
                               const wchar_t* outDir);
     ```
   * [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—É–±–ª–∏—á–Ω—ã–π ABI –Ω–µ —Ç–∞—â–∏—Ç `std::string`/`std::vector`
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

   * [ ] –ü–æ–¥–∫–ª—é—á–∏—Ç—å GoogleTest
   * [ ] –Æ–Ω–∏—Ç‚Äë—Ç–µ—Å—Ç—ã –¥–ª—è `mix_file` –∏ `shp_ts_file`
   * [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç: —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ `conquer.mix` ‚Üí —Å–≤–µ—Ä–∫–∞ SHA‚Äë1
5. **CI¬†/¬†CD**

   * [ ] GitHub Actions: matrix¬†{ windows‚Äëlatest, ubuntu‚Äëlatest }
   * [ ] –ö—ç—à vcpkg
   * [ ] –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã: `mixcons‚Äëwin.zip`, `mixcons‚Äëlinux.tar.gz`, `xcc_mix.dll`
6. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**

   * [ ] –û–±–Ω–æ–≤–∏—Ç—å `README.md` —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   * [ ] –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Doxygen‚Äë—Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è Library

## 4. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

* **–°—Ç–∞–Ω–¥–∞—Ä—Ç C++**: –º–∏–Ω–∏–º—É–º C++17 (–¥–ª—è `<filesystem>`); –µ—Å–ª–∏ –Ω—É–∂–µ–Ω `<span>`, –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º `/std:c++20`.
* **Inline¬†ASM**: –Ω–µ –≤–∫–ª—é—á–∞–µ–º —Ñ–∞–π–ª—ã —Å VQA‚Äë–∫–æ–¥–µ–∫–æ–º –≤ Linux‚Äë–±–∏–ª–¥.
* **–ü—É—Ç–∏ –∏–Ω–∫–ª—É–¥–æ–≤**:

  ```cmake
  target_include_directories(xcc PUBLIC
      $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/Library>
      $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/misc>)
  ```
* **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: —á–µ—Ä–µ–∑¬†vcpkg (`zlib`, `libpng`, `jpeg-turbo`, `bzip2`).

## 5. Acceptance¬†Criteria

| # | –ö—Ä–∏—Ç–µ—Ä–∏–π                                            | –ü—Ä–æ–≤–µ—Ä–∫–∞                                              |
| - | --------------------------------------------------- | ----------------------------------------------------- |
| 1 | `mixcons` —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç MIX –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç SHP –≤ PNG | `mixcons conquer.mix unittem.pal -o out/`¬†‚á® \~1000¬†PNG |
| 2 | DLL –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `0` –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ–º –∞—Ä—Ö–∏–≤–µ               | C#¬†P/Invoke —Ç–µ—Å—Ç                                      |
| 3 | CI –ø—Ä–æ—Ö–æ–¥–∏—Ç ¬´–∑–µ–ª—ë–Ω—ã–º¬ª –≤ MSVC¬†–∏ GCC                  | GitHub Actions badge                                  |
| 4 | –ö–æ–¥ —Å—Ç–∏–ª—å–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω `clang‚Äëformat`‚Äë–æ–º          | Pre‚Äëcommit hook                                       |

## 6. Out¬†of¬†Scope

* GUI‚Äë—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ä–æ–≥–æ XCC Mixer
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤ VQA/AUD‚Äë–ø–æ—Ç–æ–∫–æ–≤ –≤ CLI¬†v1

## 7. –î–æ–ø. —Å—Å—ã–ª–∫–∏

* [ModEnc Wiki ‚Äì MIX¬†format](https://modenc.renegadeprojects.com/MIX)
* [OlafvdSpek/xcc¬†(master)](https://github.com/OlafvdSpek/xcc)
* [Boost.Filesystem ‚Üí std::filesystem¬†migration guide](https://www.boost.org/doc/libs/1_84_0/libs/filesystem/doc/index.htm)

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω Xenon007 2025‚Äë07‚Äë10 –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ Codex.*
